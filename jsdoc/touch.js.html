<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: input/touch.js</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":true}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html"></a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="AttrRecognizer">
            <span class="title">
                <a href="AttrRecognizer.html">AttrRecognizer</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Hammer">
            <span class="title">
                <a href="Hammer.html">Hammer</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Input">
            <span class="title">
                <a href="Input.html">Input</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Input#destroy"><a href="Input.html#destroy">destroy</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Manager">
            <span class="title">
                <a href="Manager.html">Manager</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Manager#add"><a href="Manager.html#add">add</a></li>
            
                <li data-name="Manager#destroy"><a href="Manager.html#destroy">destroy</a></li>
            
                <li data-name="Manager#emit"><a href="Manager.html#emit">emit</a></li>
            
                <li data-name="Manager#get"><a href="Manager.html#get">get</a></li>
            
                <li data-name="Manager#off"><a href="Manager.html#off">off</a></li>
            
                <li data-name="Manager#on"><a href="Manager.html#on">on</a></li>
            
                <li data-name="Manager#recognize"><a href="Manager.html#recognize">recognize</a></li>
            
                <li data-name="Manager#remove"><a href="Manager.html#remove">remove</a></li>
            
                <li data-name="Manager#set"><a href="Manager.html#set">set</a></li>
            
                <li data-name="Manager#stop"><a href="Manager.html#stop">stop</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="MouseInput">
            <span class="title">
                <a href="MouseInput.html">MouseInput</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="PanRecognizer">
            <span class="title">
                <a href="PanRecognizer.html">PanRecognizer</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="PinchRecognizer">
            <span class="title">
                <a href="PinchRecognizer.html">PinchRecognizer</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="PointerEventInput">
            <span class="title">
                <a href="PointerEventInput.html">PointerEventInput</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="PressRecognizer">
            <span class="title">
                <a href="PressRecognizer.html">PressRecognizer</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Recognizer">
            <span class="title">
                <a href="Recognizer.html">Recognizer</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Recognizer#defaults"><a href="Recognizer.html#defaults">defaults</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Recognizer#canRecognizeWith"><a href="Recognizer.html#canRecognizeWith">canRecognizeWith</a></li>
            
                <li data-name="Recognizer#dropRecognizeWith"><a href="Recognizer.html#dropRecognizeWith">dropRecognizeWith</a></li>
            
                <li data-name="Recognizer#dropRequireFailure"><a href="Recognizer.html#dropRequireFailure">dropRequireFailure</a></li>
            
                <li data-name="Recognizer#emit"><a href="Recognizer.html#emit">emit</a></li>
            
                <li data-name="Recognizer#getTouchAction"><a href="Recognizer.html#getTouchAction">getTouchAction</a></li>
            
                <li data-name="Recognizer#process"><a href="Recognizer.html#process">process</a></li>
            
                <li data-name="Recognizer#recognize"><a href="Recognizer.html#recognize">recognize</a></li>
            
                <li data-name="Recognizer#recognizeWith"><a href="Recognizer.html#recognizeWith">recognizeWith</a></li>
            
                <li data-name="Recognizer#requireFailure"><a href="Recognizer.html#requireFailure">requireFailure</a></li>
            
                <li data-name="Recognizer#reset"><a href="Recognizer.html#reset">reset</a></li>
            
                <li data-name="Recognizer#set"><a href="Recognizer.html#set">set</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="RotateRecognizer">
            <span class="title">
                <a href="RotateRecognizer.html">RotateRecognizer</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="SwipeRecognizer">
            <span class="title">
                <a href="SwipeRecognizer.html">SwipeRecognizer</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="TapRecognizer">
            <span class="title">
                <a href="TapRecognizer.html">TapRecognizer</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="TouchAction">
            <span class="title">
                <a href="TouchAction.html">TouchAction</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="TouchAction#compute"><a href="TouchAction.html#compute">compute</a></li>
            
                <li data-name="TouchAction#preventDefaults"><a href="TouchAction.html#preventDefaults">preventDefaults</a></li>
            
                <li data-name="TouchAction#preventSrc"><a href="TouchAction.html#preventSrc">preventSrc</a></li>
            
                <li data-name="TouchAction#set"><a href="TouchAction.html#set">set</a></li>
            
                <li data-name="TouchAction#update"><a href="TouchAction.html#update">update</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="TouchInput">
            <span class="title">
                <a href="TouchInput.html">TouchInput</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="TouchMouseInput">
            <span class="title">
                <a href="TouchMouseInput.html">TouchMouseInput</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="touch.js.html">Source: input/touch.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>var TOUCH_INPUT_MAP = {
    touchstart: INPUT_START,
    touchmove: INPUT_MOVE,
    touchend: INPUT_END,
    touchcancel: INPUT_CANCEL
};

var TOUCH_EVENTS = 'touchstart touchmove touchend touchcancel';

/**
 * Touch events input
 * @constructor
 */
function TouchInput() {
    this.elEvents = TOUCH_EVENTS;
    this.targetIds = {};

    Input.apply(this, arguments);
}

inherit(TouchInput, Input, {
    /**
     * handle touch events
     * @param {Object} ev
     */
    handler: function(ev) {
        var touches = normalizeTouches(ev, this);
        this.callback(this.manager, TOUCH_INPUT_MAP[ev.type], {
            pointers: touches[0],
            changedPointers: touches[1],
            pointerType: INPUT_TYPE_TOUCH,
            srcEvent: ev
        });
    }
});

/**
 * make sure all browsers return the same touches
 * @param {Object} ev
 * @param {TouchInput} touchInput
 * @returns {Array} [all, changed]
 */
function normalizeTouches(ev, touchInput) {
    var i, len;

    var targetIds = touchInput.targetIds;
    var targetTouches = toArray(ev.targetTouches);
    var changedTouches = toArray(ev.changedTouches);
    var changedTargetTouches = [];

    // collect touches
    if (ev.type == 'touchstart') {
        for (i = 0, len = targetTouches.length; i &lt; len; i++) {
            targetIds[targetTouches[i].identifier] = true;
        }
    }

    // filter changed touches to only contain touches that exist in the collected target ids
    for (i = 0, len = changedTouches.length; i &lt; len; i++) {
        if (targetIds[changedTouches[i].identifier]) {
            changedTargetTouches.push(changedTouches[i]);
        }

        // cleanup removed touches
        if (ev.type == 'touchend'|| ev.type == 'touchcancel') {
            delete targetIds[changedTouches[i].identifier];
        }
    }

    return [
        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'
        // also removed the duplicates
        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier'),

        // only the changed :-)
        changedTargetTouches
    ];
}
</code></pre>
        </article>
    </section>





        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Mon Jun 30 2014 12:15:54 GMT+0200 (W. Europe Daylight Time)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
